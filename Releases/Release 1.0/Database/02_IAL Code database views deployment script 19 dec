

-- ----------------------------------------------------------------------------
-- View IAL.IAL_View_Candidate_Category
-- ----------------------------------------------------------------------------
USE `IAL`;
CREATE  OR REPLACE   VIEW `IAL`.`IAL_View_Candidate_Category` AS select `category`.`id` AS `id`,`cquestion`.`candidateId` AS `candidateId`,`category`.`categoryName` AS `categoryName`,concat(cast(`GETCOUNTOFSUBMITEDQUESTIONS`(`category`.`id`,`cquestion`.`candidateId`) as signed),' / ',cast(`GETTOTALNOOFQUESTIONSFORCATEGORY`(`category`.`id`) as signed)) AS `questionsSubmited`,concat(cast(if(isnull(`GETTOTALOFSUBMITEDQUESTIONSWEIGHTAGE`(`category`.`id`,`cquestion`.`candidateId`)),0,`GETTOTALOFSUBMITEDQUESTIONSWEIGHTAGE`(`category`.`id`,`cquestion`.`candidateId`)) as signed),' / ',concat(cast(if(isnull(`GETTOTALWEIGHTAGEOFCATEGORY`(`category`.`id`)),0,`GETTOTALWEIGHTAGEOFCATEGORY`(`category`.`id`)) as signed))) AS `weightageSubmited` from ((`IAL`.`IAL_Category` `category` left join `IAL`.`IAL_Question` `question` on(((`category`.`id` = `question`.`categoryId`) and (`category`.`isActive` = TRUE) and (`question`.`isActive` = TRUE)))) join `IAL`.`IAL_Candidate_Question` `cquestion`) group by `category`.`id`,`category`.`categoryName`,`cquestion`.`candidateId` union select `category`.`id` AS `id`,NULL AS `candidateId`,`category`.`categoryName` AS `categoryName`,concat(cast(`GETCOUNTOFSUBMITEDQUESTIONS`(`category`.`id`,NULL) as signed),' / ',cast(`GETTOTALNOOFQUESTIONSFORCATEGORY`(`category`.`id`) as signed)) AS `questionsSubmited`,concat(cast(if(isnull(`GETTOTALOFSUBMITEDQUESTIONSWEIGHTAGE`(`category`.`id`,NULL)),0,`GETTOTALOFSUBMITEDQUESTIONSWEIGHTAGE`(`category`.`id`,NULL)) as signed),' / ',concat(cast(if(isnull(`GETTOTALWEIGHTAGEOFCATEGORY`(`category`.`id`)),0,`GETTOTALWEIGHTAGEOFCATEGORY`(`category`.`id`)) as signed))) AS `weightageSubmited` from (`IAL`.`IAL_Category` `category` left join `IAL`.`IAL_Question` `question` on(((`category`.`id` = `question`.`categoryId`) and (`category`.`isActive` = TRUE) and (`question`.`isActive` = TRUE)))) group by `category`.`id`,`category`.`categoryName`;

-- ----------------------------------------------------------------------------
-- View IAL.IAL_View_Candidate_Question_Score
-- ----------------------------------------------------------------------------
USE `IAL`;
CREATE  OR REPLACE ALGORITHM=UNDEFINED  VIEW `IAL`.`IAL_View_Candidate_Question_Score` AS (select `IAL`.`SETROWNUMBER`(1) AS `id`,`questionCandidate`.`candidateId` AS `candidateId`,`questionCandidate`.`questionId` AS `questionId`,`questionCandidate`.`questionCode` AS `questionCode`,`questionCandidate`.`questionName` AS `questionName`,`questionCandidate`.`questionDescription` AS `questionDescription`,`questionCandidate`.`questionDocumetId` AS `questionDocumetId`,`questionCandidate`.`questionDocumentName` AS `questionDocumentName`,`questionCandidate`.`evaluationTimeInHours` AS `evaluationTimeInHours`,`questionCandidate`.`questionStatus` AS `questionStatus`,`questionCandidate`.`categoryName` AS `categoryName`,`questionCandidate`.`startDate` AS `questionStartDate`,`questionCandidate`.`endDate` AS `questionEndDate`,`questionCandidate`.`topicName` AS `topicName`,`questionCandidate`.`weightage` AS `weightage`,`questionCandidate`.`relevancePoints` AS `relevancePoints`,`questionCandidate`.`isQuestionActive` AS `isQuestionActive`,`questionCandidate`.`questionCreatedOn` AS `questionCreatedOn`,`questionCandidate`.`questionCreatedBy` AS `questionCreatedBy`,`questionCandidate`.`questionUpdatedOn` AS `questionUpdatedOn`,`questionCandidate`.`questionUpdatedBy` AS `questionUpdatedBy`,`questionCandidate`.`candidateQuestionId` AS `candidateQuestionId`,`solutions`.`id` AS `questionSolutionId`,`evaluation`.`id` AS `questionEvaluationId`,`evaluation`.`marksGiven` AS `evaluationScore`,`evaluation`.`feedback` AS `evaluationFeedback`,`evaluation`.`evaluationStartDate` AS `evaluationStartDate`,`evaluation`.`evaluationEndDate` AS `evaluationEndDate`,`eStatus`.`statusName` AS `evaluationStatus`,`cqStatus`.`statusName` AS `questionSolutionStatus` from (((((select `IAL`.`SETROWNUMBER`(0) AS `resetRowNumber`)) `rowNumber` join (((((select `candidate`.`id` AS `candidateId`,`questions`.`id` AS `questionId`,`questions`.`questionCode` AS `questionCode`,`questions`.`questionName` AS `questionName`,`questions`.`questionDescription` AS `questionDescription`,`questions`.`questionDocumetId` AS `questionDocumetId`,`questions`.`questionDocumentName` AS `questionDocumentName`,`questions`.`evaluationTimeInHours` AS `evaluationTimeInHours`,`qStatus`.`statusName` AS `questionStatus`,`category`.`categoryName` AS `categoryName`,`questions`.`startDate` AS `startDate`,`questions`.`endDate` AS `endDate`,`topics`.`topicName` AS `topicName`,`questions`.`weightage` AS `weightage`,`questions`.`relevancePoints` AS `relevancePoints`,`questions`.`isActive` AS `isQuestionActive`,`questions`.`createdOn` AS `questionCreatedOn`,`questions`.`createdBy` AS `questionCreatedBy`,`questions`.`updatedOn` AS `questionUpdatedOn`,`questions`.`updatedBy` AS `questionUpdatedBy`,max(`cQuestion`.`id`) AS `candidateQuestionId` from (((`IAL`.`IAL_Candidate` `candidate` join ((`IAL`.`IAL_Question` `questions` join `IAL`.`IAL_Category` `category` on((`questions`.`categoryId` = `category`.`id`))) join `IAL`.`IAL_Topic_Lookup` `topics` on((`questions`.`topicId` = `topics`.`id`)))) join `IAL`.`IAL_Status_Lookup` `qStatus` on((`qStatus`.`id` = `questions`.`questionComplexityId`))) left join `IAL`.`IAL_Candidate_Question` `cQuestion` on(((`cQuestion`.`questionId` = `questions`.`id`) and (`cQuestion`.`candidateId` = `candidate`.`id`)))) group by `candidate`.`id`,`questions`.`id`)) `questionCandidate` left join `IAL`.`IAL_Question_Solution` `solutions` on((`solutions`.`candidateQuestionId` = `questionCandidate`.`candidateQuestionId`))) left join `IAL`.`IAL_Question_Evaluation` `evaluation` on((`evaluation`.`questionSolutionId` = `solutions`.`id`))) left join `IAL`.`IAL_Status_Lookup` `eStatus` on((`eStatus`.`id` = `evaluation`.`questionEvaluationStatusId`)))) left join `IAL`.`IAL_Candidate_Question` `cQuestion2` on((`cQuestion2`.`id` = `questionCandidate`.`candidateQuestionId`))) left join `IAL`.`IAL_Status_Lookup` `cqStatus` on((`cqStatus`.`id` = `cQuestion2`.`questionStatusId`))));

-- ----------------------------------------------------------------------------
-- View IAL.IAL_View_Question
-- ----------------------------------------------------------------------------
USE `IAL`;
CREATE  OR REPLACE   VIEW `IAL`.`IAL_View_Question` AS select `question`.`id` AS `questionId`,`question`.`questionCode` AS `questionCode`,`question`.`questionName` AS `questionName`,`question`.`questionDescription` AS `questionDescription`,`question`.`questionDocumetId` AS `questionDocumentId`,`question`.`questionDocumentName` AS `questionDocumentName`,`question`.`evaluationTimeInHours` AS `evaluationTimeInHours`,`question`.`categoryId` AS `categoryId`,`question`.`startDate` AS `startDate`,`question`.`endDate` AS `endDate`,`question`.`topicId` AS `topicId`,`question`.`questionComplexityId` AS `questionComplexityId`,`question`.`weightage` AS `weightage`,`question`.`relevancePoints` AS `relevancePoints`,`question`.`isActive` AS `isActive`,`question`.`createdOn` AS `createdOn`,`question`.`createdBy` AS `createdBy`,`question`.`updatedOn` AS `updatedOn`,`question`.`updatedBy` AS `updatedBy`,`category`.`categoryName` AS `categoryName`,`topic`.`topicName` AS `topicName`,`qStatus`.`statusName` AS `questionComplexity` from (((`IAL`.`IAL_Question` `question` join `IAL`.`IAL_Category` `category` on((`question`.`categoryId` = `category`.`id`))) join `IAL`.`IAL_Topic_Lookup` `topic` on((`question`.`topicId` = `topic`.`id`))) join `IAL`.`IAL_Status_Lookup` `qStatus` on((`question`.`questionComplexityId` = `qStatus`.`id`)));
